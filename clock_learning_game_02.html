<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ü§ñ ÊôÇÈêòÂ≠∏ÁøíÂ§ßÊåëÊà∞02 - Ë∂ÖËÉΩÂäõÈú∏ÁéãÊî∂ÈõÜÁâà</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: 'Comic Sans MS', cursive, Arial, sans-serif;
            background: linear-gradient(135deg, #2d3436 0%, #636e72 50%, #74b9ff 100%);
            min-height: 100vh;
            display: flex;
            justify-content: center;
            align-items: center;
            padding: 20px;
            color: white;
        }
        
        .game-container {
            background: rgba(255, 255, 255, 0.95);
            border-radius: 25px;
            padding: 30px;
            max-width: 1000px;
            width: 100%;
            box-shadow: 0 25px 50px rgba(0,0,0,0.3);
            text-align: center;
            color: #2d3436;
            border: 3px solid #ffeaa7;
        }
        
        h1 {
            color: #2d3436;
            margin-bottom: 20px;
            font-size: 2.8em;
            text-shadow: 2px 2px 4px rgba(255, 234, 167, 0.3);
            background: linear-gradient(45deg, #e17055, #fd79a8);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }
        
        .score-board {
            display: flex;
            justify-content: space-between;
            margin-bottom: 30px;
            padding: 20px;
            background: linear-gradient(135deg, #74b9ff, #0984e3);
            border-radius: 15px;
            color: white;
            border: 2px solid #ffeaa7;
        }
        
        .score-item {
            font-size: 1.3em;
            font-weight: bold;
            text-shadow: 1px 1px 2px rgba(0,0,0,0.3);
        }
        
        .clocks-container {
            display: flex;
            justify-content: space-around;
            margin: 30px 0;
            flex-wrap: wrap;
            gap: 30px;
        }
        
        .clock-section {
            flex: 1;
            min-width: 250px;
        }
        
        .clock-label {
            font-size: 1.5em;
            font-weight: bold;
            margin-bottom: 15px;
            padding: 10px;
            background: linear-gradient(135deg, #e17055, #fd79a8);
            color: white;
            border-radius: 20px;
            text-shadow: 1px 1px 2px rgba(0,0,0,0.3);
        }
        
        .clock-canvas {
            border: 4px solid #ffeaa7;
            border-radius: 50%;
            background: white;
            box-shadow: 0 15px 30px rgba(0,0,0,0.2);
            margin: 0 auto;
            display: block;
        }
        
        .time-display {
            margin: 15px 0;
            padding: 15px;
            background: linear-gradient(135deg, #00b894, #00cec9);
            color: white;
            border-radius: 15px;
            font-size: 1.3em;
            font-weight: bold;
            text-shadow: 1px 1px 2px rgba(0,0,0,0.3);
            border: 2px solid #ffeaa7;
        }
        
        .question-section {
            margin: 30px 0;
            padding: 25px;
            background: linear-gradient(135deg, #a29bfe, #6c5ce7);
            border-radius: 20px;
            color: white;
            border: 3px solid #ffeaa7;
        }
        
        .question-section h3 {
            font-size: 1.8em;
            margin-bottom: 20px;
            text-shadow: 1px 1px 2px rgba(0,0,0,0.3);
        }
        
        .time-inputs {
            display: flex;
            justify-content: center;
            align-items: center;
            gap: 15px;
            margin: 25px 0;
            flex-wrap: wrap;
        }
        
        .time-input {
            padding: 12px 18px;
            border: 3px solid #ffeaa7;
            border-radius: 15px;
            font-size: 1.6em;
            width: 120px;
            text-align: center;
            font-weight: bold;
            background: white;
            color: #2d3436;
        }
        
        .time-input:focus {
            outline: none;
            border-color: #e17055;
            box-shadow: 0 0 15px rgba(225, 112, 85, 0.5);
            transform: scale(1.05);
        }
        
        .time-label {
            font-size: 1.2em;
            font-weight: bold;
            color: #ffeaa7;
            text-shadow: 1px 1px 2px rgba(0,0,0,0.5);
        }
        
        .submit-btn {
            background: linear-gradient(135deg, #00b894, #00cec9);
            color: white;
            border: none;
            padding: 18px 35px;
            border-radius: 30px;
            font-size: 1.4em;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.3s ease;
            margin: 25px 15px;
            border: 3px solid #ffeaa7;
            text-shadow: 1px 1px 2px rgba(0,0,0,0.3);
        }
        
        .submit-btn:hover {
            transform: translateY(-3px) scale(1.05);
            box-shadow: 0 15px 30px rgba(0, 184, 148, 0.4);
        }
        
        .next-btn {
            background: linear-gradient(135deg, #e17055, #fd79a8);
            color: white;
            border: none;
            padding: 18px 35px;
            border-radius: 30px;
            font-size: 1.4em;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.3s ease;
            margin: 25px 15px;
            border: 3px solid #ffeaa7;
            text-shadow: 1px 1px 2px rgba(0,0,0,0.3);
        }
        
        .next-btn:hover {
            transform: translateY(-3px) scale(1.05);
            box-shadow: 0 15px 30px rgba(225, 112, 85, 0.4);
        }
        
        .feedback {
            margin: 25px 0;
            padding: 20px;
            border-radius: 15px;
            font-size: 1.4em;
            font-weight: bold;
            min-height: 70px;
            display: flex;
            align-items: center;
            justify-content: center;
            border: 3px solid;
        }
        
        .correct {
            background: linear-gradient(135deg, #00b894, #00cec9);
            color: white;
            border-color: #ffeaa7;
            text-shadow: 1px 1px 2px rgba(0,0,0,0.3);
        }
        
        .incorrect {
            background: linear-gradient(135deg, #e17055, #fd79a8);
            color: white;
            border-color: #ffeaa7;
            text-shadow: 1px 1px 2px rgba(0,0,0,0.3);
        }
        
        .ultraman-reward {
            margin: 25px 0;
            animation: heroAppear 0.8s ease;
        }
        
        .ultraman-character {
            font-size: 5em;
            margin: 15px;
            animation: heroPower 2s infinite;
            text-shadow: 0 0 20px rgba(255, 234, 167, 0.8);
        }
        
        .collected-ultramen {
            margin: 25px 0;
            padding: 25px;
            background: linear-gradient(135deg, #2d3436, #636e72);
            border-radius: 20px;
            color: white;
            border: 3px solid #ffeaa7;
        }
        
        .collected-ultramen h3 {
            color: #ffeaa7;
            margin-bottom: 20px;
            text-shadow: 1px 1px 2px rgba(0,0,0,0.5);
        }
        
        .ultraman-collection {
            display: flex;
            flex-wrap: wrap;
            justify-content: center;
            gap: 15px;
            max-height: 250px;
            overflow-y: auto;
        }
        
        .ultraman-badge {
            font-size: 2.5em;
            padding: 15px;
            background: linear-gradient(135deg, #e17055, #fd79a8);
            border-radius: 50%;
            box-shadow: 0 8px 16px rgba(0,0,0,0.3);
            animation: ultramanGlow 0.8s ease;
            transition: transform 0.3s ease;
            border: 3px solid #ffeaa7;
            text-shadow: 0 0 15px rgba(255, 234, 167, 0.8);
        }
        
        .ultraman-badge:hover {
            transform: scale(1.2) rotate(10deg);
        }
        
        .progress-bar {
            margin: 20px 0;
            background: #636e72;
            border-radius: 15px;
            height: 25px;
            overflow: hidden;
            border: 2px solid #ffeaa7;
        }
        
        .progress-fill {
            height: 100%;
            background: linear-gradient(90deg, #00b894, #00cec9, #74b9ff);
            transition: width 0.8s ease;
            border-radius: 15px;
            box-shadow: 0 0 20px rgba(0, 184, 148, 0.5);
        }
        
        .final-screen {
            text-align: center;
            padding: 40px;
            background: linear-gradient(135deg, #2d3436, #636e72);
            border-radius: 20px;
            color: white;
            border: 3px solid #ffeaa7;
        }
        
        .restart-btn {
            background: linear-gradient(135deg, #ffeaa7, #fdcb6e);
            color: #2d3436;
            border: none;
            padding: 18px 35px;
            border-radius: 30px;
            font-size: 1.4em;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.3s ease;
            margin: 25px;
            border: 3px solid #e17055;
        }
        
        .restart-btn:hover {
            transform: translateY(-3px) scale(1.05);
            box-shadow: 0 15px 30px rgba(255, 234, 167, 0.4);
        }
        
        /* Ë∂ÖËÉΩÂäõÈú∏Áéã‰∏ªÈ°åÂãïÁï´ */
        @keyframes heroAppear {
            0% { transform: scale(0) rotate(0deg); opacity: 0; }
            50% { transform: scale(1.3) rotate(180deg); opacity: 0.8; }
            100% { transform: scale(1) rotate(360deg); opacity: 1; }
        }
        
        @keyframes heroPower {
            0%, 100% { transform: scale(1); filter: brightness(1); }
            50% { transform: scale(1.1); filter: brightness(1.5); }
        }
        
        @keyframes ultramanGlow {
            0% { 
                opacity: 0; 
                transform: scale(0.5); 
                box-shadow: 0 0 0 rgba(255, 234, 167, 0); 
            }
            50% { 
                opacity: 0.8; 
                transform: scale(1.2); 
                box-shadow: 0 0 30px rgba(255, 234, 167, 0.8); 
            }
            100% { 
                opacity: 1; 
                transform: scale(1); 
                box-shadow: 0 8px 16px rgba(0,0,0,0.3); 
            }
        }
        
        .hidden {
            display: none;
        }
        
        /* ÈüøÊáâÂºèË®≠Ë®à */
        @media (max-width: 768px) {
            .clocks-container {
                flex-direction: column;
            }
            
            .score-board {
                flex-direction: column;
                gap: 10px;
            }
            
            h1 {
                font-size: 2rem;
            }
            
            .time-inputs {
                flex-direction: column;
            }
        }
        
        /* ÁâπÊÆäÂ•ßÁâπÊõºÊïàÊûú */
        .special-effect {
            position: absolute;
            pointer-events: none;
            font-size: 3em;
            animation: specialBlast 1.5s ease-out forwards;
            z-index: 1000;
        }
        
        @keyframes specialBlast {
            0% { 
                transform: scale(0) rotate(0deg); 
                opacity: 1; 
            }
            50% { 
                transform: scale(2) rotate(180deg); 
                opacity: 0.8; 
            }
            100% { 
                transform: scale(4) rotate(360deg); 
                opacity: 0; 
            }
        }
    </style>
</head>
<body>
    <div class="game-container">
        <h1>ü§ñ ÊôÇÈêòÂ≠∏ÁøíÂ§ßÊåëÊà∞02 - Ë∂ÖËÉΩÂäõÈú∏ÁéãÊî∂ÈõÜÁâà</h1>
        
        <div class="score-board">
            <div class="score-item">È°åÁõÆ: <span id="currentQuestion">1</span>/20</div>
            <div class="score-item">Á≠îÂ∞ç: <span id="correctCount">0</span></div>
            <div class="score-item">Ë∂ÖËÉΩÂäõÈú∏ÁéãÊî∂ÈõÜ: <span id="ultramanCount">0</span></div>
        </div>
        
        <div id="gameScreen">
            <div class="clocks-container">
                <div class="clock-section">
                    <div class="clock-label">üïê ÊôÇÈñìA (ÈñãÂßãÊôÇÈñì)</div>
                    <canvas id="clockA" class="clock-canvas" width="250" height="250"></canvas>
                    <div id="timeDisplayA" class="time-display">üïê Ë´ã‰ªîÁ¥∞ËßÄÂØüÊôÇÈêò</div>
                </div>
                
                <div class="clock-section">
                    <div class="clock-label">üïë ÊôÇÈñìB (ÁµêÊùüÊôÇÈñì)</div>
                    <canvas id="clockB" class="clock-canvas" width="250" height="250"></canvas>
                    <div id="timeDisplayB" class="time-display">üïë Ë´ã‰ªîÁ¥∞ËßÄÂØüÊôÇÈêò</div>
                </div>
            </div>
            
            <div class="question-section">
                <h3>‚ö° ÊåëÊà∞‰ªªÂãôÔºö‰ªîÁ¥∞ËßÄÂØüÂÖ©ÂÄãÊôÇÈêòÔºåË®àÁÆóÂæûÊôÇÈñìAÂà∞ÊôÇÈñìBÈúÄË¶ÅÂ§öÈï∑ÊôÇÈñìÔºü</h3>
                <p style="color: #ffeaa7; font-size: 1.1em; margin: 10px 0;">
                    üîç ÊèêÁ§∫ÔºöÂÖàËÆÄÂá∫ÂÖ©ÂÄãÊôÇÈêòÁöÑÊôÇÈñìÔºåÂÜçË®àÁÆóÊôÇÈñìÂ∑Æ
                </p>
                <div class="time-inputs">
                    <div class="time-label">Â∞èÊôÇ</div>
                    <input type="text" id="hourInput" class="time-input" maxlength="2" placeholder="ÊôÇ">
                    <div class="time-label">ÂàÜÈêò</div>
                    <input type="text" id="minuteInput" class="time-input" maxlength="2" placeholder="ÂàÜ">
                </div>
                <button onclick="checkAnswer()" class="submit-btn">üöÄ Êèê‰∫§Á≠îÊ°à</button>
            </div>
            
            <div id="feedback" class="feedback"></div>
            
            <div id="ultramanReward" class="ultraman-reward hidden"></div>
            
            <button id="nextBtn" onclick="nextQuestion()" class="next-btn hidden">‰∏ã‰∏ÄÈ°å ‚ö°</button>
        </div>
        
        <div id="finalScreen" class="final-screen hidden">
            <h2>üéâ ÊÅ≠ÂñúÂÆåÊàêË∂ÖËÉΩÂäõÈú∏ÁéãÊôÇÈêòÊåëÊà∞ÔºÅ</h2>
            <p>Á∏ΩÂÖ±Á≠îÂ∞ç‰∫Ü <span id="finalScore"></span> È°å</p>
            <p>Êî∂ÈõÜ‰∫Ü <span id="finalUltramen"></span> ‰ΩçË∂ÖËÉΩÂäõÈú∏ÁéãËã±ÈõÑÔºÅ</p>
            <div id="finalMessage" style="margin: 25px 0; font-size: 1.3em;"></div>
            <button onclick="restartGame()" class="restart-btn">üîÑ ÈáçÊñ∞ÊåëÊà∞</button>
        </div>
        
        <div class="collected-ultramen">
            <h3>ü§ñ Ë∂ÖËÉΩÂäõÈú∏ÁéãËã±ÈõÑÊî∂ÈõÜÈÄ≤Â∫¶Ôºö<span id="progressText">0/20</span></h3>
            <div class="progress-bar">
                <div id="progressFill" class="progress-fill" style="width: 0%"></div>
            </div>
            <div id="ultramanCollection" class="ultraman-collection"></div>
        </div>
    </div>

    <script>
        // ÈÅäÊà≤ÁãÄÊÖã
        let currentQuestion = 1;
        let correctCount = 0;
        let timeA = { hour: 0, minute: 0 };
        let timeB = { hour: 0, minute: 0 };
        let correctDifference = { hours: 0, minutes: 0 };
        let collectedUltramen = [];
        
        // Ë∂ÖËÉΩÂäõÈú∏ÁéãËã±ÈõÑÂàóË°® - 20‰Ωç‰∏çÂêåÁöÑË∂ÖËÉΩÂäõÈú∏Áéã
        const ultramanHeroes = [
            'ü§ñ', 'üëΩ', 'üõ∏', '‚ö°', 'üî•', 
            '‚ú®', 'üí´', 'üåü', 'üí•', 'üîÆ', 
            'üöÄ', 'üõ°Ô∏è', '‚öîÔ∏è', 'üéØ', 'üíé', 
            'üåà', '‚ùÑÔ∏è', 'üå™Ô∏è', 'üåä', '‚öõÔ∏è'
        ];
        
        // ÂàùÂßãÂåñÈÅäÊà≤
        function initGame() {
            generateNewTimes();
            drawClocks();
            showTimeTips();
            updateDisplay();
        }
        
        // ÁîüÊàêÊñ∞ÁöÑÈö®Ê©üÊôÇÈñì
        function generateNewTimes() {
            // ÁîüÊàêÊôÇÈñìA
            timeA.hour = Math.floor(Math.random() * 12) + 1;
            timeA.minute = Math.floor(Math.random() * 12) * 5;
            
            // ÁîüÊàêÊôÇÈñìB (Á¢∫‰øùBÂú®A‰πãÂæå)
            let minMinutesLater = 15; // ÊúÄÂ∞ë15ÂàÜÈêòÂæå
            let maxMinutesLater = 480; // ÊúÄÂ§ö8Â∞èÊôÇÂæå
            let minutesLater = Math.floor(Math.random() * (maxMinutesLater - minMinutesLater + 1)) + minMinutesLater;
            
            let totalMinutesA = timeA.hour * 60 + timeA.minute;
            let totalMinutesB = totalMinutesA + minutesLater;
            
            // Â¶ÇÊûúË∂ÖÈÅé24Â∞èÊôÇÔºåË™øÊï¥Âà∞‰∏ã‰∏ÄÂ§©
            if (totalMinutesB >= 24 * 60) {
                totalMinutesB = totalMinutesB % (24 * 60);
            }
            
            timeB.hour = Math.floor(totalMinutesB / 60);
            if (timeB.hour === 0) timeB.hour = 12;
            if (timeB.hour > 12) timeB.hour = timeB.hour - 12;
            
            timeB.minute = totalMinutesB % 60;
            
            // Ë®àÁÆóÊ≠£Á¢∫ÁöÑÊôÇÈñìÂ∑Æ
            calculateTimeDifference();
        }
        
        // Ë®àÁÆóÊôÇÈñìÂ∑Æ
        function calculateTimeDifference() {
            let totalMinutesA = timeA.hour * 60 + timeA.minute;
            let totalMinutesB = timeB.hour * 60 + timeB.minute;
            
            // Â¶ÇÊûúBÂ∞èÊñºAÔºåË°®Á§∫Ë∑®Ë∂ä‰∫Ü12Â∞èÊôÇ
            if (totalMinutesB < totalMinutesA) {
                totalMinutesB += 12 * 60;
            }
            
            let diffMinutes = totalMinutesB - totalMinutesA;
            correctDifference.hours = Math.floor(diffMinutes / 60);
            correctDifference.minutes = diffMinutes % 60;
        }
        
        // È°ØÁ§∫ÊèêÁ§∫ÊñáÂ≠óÔºà‰∏çÈ°ØÁ§∫ÂÖ∑È´îÊôÇÈñìÔºâ
        function showTimeTips() {
            const displayA = document.getElementById('timeDisplayA');
            const displayB = document.getElementById('timeDisplayB');
            
            displayA.textContent = 'üïê Ë´ã‰ªîÁ¥∞ËßÄÂØüÊôÇÈêòA';
            displayB.textContent = 'üïë Ë´ã‰ªîÁ¥∞ËßÄÂØüÊôÇÈêòB';
        }
        
        // Áπ™Ë£ΩÊôÇÈêò
        function drawClock(canvasId, time) {
            const canvas = document.getElementById(canvasId);
            const ctx = canvas.getContext('2d');
            const centerX = canvas.width / 2;
            const centerY = canvas.height / 2;
            const radius = 100;
            
            // Ê∏ÖÈô§Áï´Â∏É
            ctx.clearRect(0, 0, canvas.width, canvas.height);
            
            // Áπ™Ë£ΩÊôÇÈêòÂ§ñÂúì
            ctx.beginPath();
            ctx.arc(centerX, centerY, radius, 0, 2 * Math.PI);
            ctx.strokeStyle = '#2d3436';
            ctx.lineWidth = 3;
            ctx.stroke();
            
            // Áπ™Ë£ΩÊôÇÈêòÊï∏Â≠ó
            ctx.font = 'bold 18px Arial';
            ctx.fillStyle = '#2d3436';
            ctx.textAlign = 'center';
            ctx.textBaseline = 'middle';
            
            for (let i = 1; i <= 12; i++) {
                const angle = (i - 3) * Math.PI / 6;
                const x = centerX + Math.cos(angle) * (radius - 25);
                const y = centerY + Math.sin(angle) * (radius - 25);
                ctx.fillText(i.toString(), x, y);
            }
            
            // Áπ™Ë£ΩÊôÇÈêòÂàªÂ∫¶
            for (let i = 0; i < 60; i++) {
                const angle = i * Math.PI / 30;
                const isHour = i % 5 === 0;
                const tickLength = isHour ? 15 : 8;
                const tickWidth = isHour ? 2 : 1;
                
                const startX = centerX + Math.cos(angle) * (radius - tickLength);
                const startY = centerY + Math.sin(angle) * (radius - tickLength);
                const endX = centerX + Math.cos(angle) * radius;
                const endY = centerY + Math.sin(angle) * radius;
                
                ctx.beginPath();
                ctx.moveTo(startX, startY);
                ctx.lineTo(endX, endY);
                ctx.strokeStyle = '#2d3436';
                ctx.lineWidth = tickWidth;
                ctx.stroke();
            }
            
            // Áπ™Ë£ΩÂàÜÈáù
            const minuteAngle = (time.minute - 15) * Math.PI / 30;
            const minuteLength = radius - 30;
            ctx.beginPath();
            ctx.moveTo(centerX, centerY);
            ctx.lineTo(
                centerX + Math.cos(minuteAngle) * minuteLength,
                centerY + Math.sin(minuteAngle) * minuteLength
            );
            ctx.strokeStyle = '#74b9ff';
            ctx.lineWidth = 3;
            ctx.stroke();
            
            // Áπ™Ë£ΩÊôÇÈáù
            const hourAngle = ((time.hour + time.minute / 60) - 3) * Math.PI / 6;
            const hourLength = radius - 50;
            ctx.beginPath();
            ctx.moveTo(centerX, centerY);
            ctx.lineTo(
                centerX + Math.cos(hourAngle) * hourLength,
                centerY + Math.sin(hourAngle) * hourLength
            );
            ctx.strokeStyle = '#e17055';
            ctx.lineWidth = 4;
            ctx.stroke();
            
            // Áπ™Ë£Ω‰∏≠ÂøÉÂúìÈªû
            ctx.beginPath();
            ctx.arc(centerX, centerY, 8, 0, 2 * Math.PI);
            ctx.fillStyle = '#2d3436';
            ctx.fill();
        }
        
        // Áπ™Ë£ΩÂÖ©ÂÄãÊôÇÈêò
        function drawClocks() {
            drawClock('clockA', timeA);
            drawClock('clockB', timeB);
        }
        
        // Ê™¢Êü•Á≠îÊ°à
        function checkAnswer() {
            const hourInputValue = document.getElementById('hourInput').value.trim();
            const minuteInputValue = document.getElementById('minuteInput').value.trim();
            const feedback = document.getElementById('feedback');
            const ultramanReward = document.getElementById('ultramanReward');
            const nextBtn = document.getElementById('nextBtn');
            
            if (!hourInputValue || !minuteInputValue) {
                feedback.textContent = '‚ö†Ô∏è Ë´ãËº∏ÂÖ•ÂÆåÊï¥ÁöÑÊôÇÈñìÂ∑ÆÔºÅ';
                feedback.className = 'feedback incorrect';
                return;
            }
            
            const hourInput = parseInt(hourInputValue);
            const minuteInput = parseInt(minuteInputValue);
            
            if (isNaN(hourInput) || isNaN(minuteInput) || 
                hourInput < 0 || hourInput > 12 || 
                minuteInput < 0 || minuteInput > 59) {
                feedback.textContent = '‚ö†Ô∏è Ë´ãËº∏ÂÖ•ÊúâÊïàÁöÑÊôÇÈñìÊ†ºÂºèÔºÅÔºàÊôÇÔºö0-12ÔºåÂàÜÔºö0-59Ôºâ';
                feedback.className = 'feedback incorrect';
                return;
            }
            
            if (hourInput === correctDifference.hours && minuteInput === correctDifference.minutes) {
                correctCount++;
                feedback.textContent = 'üéâ Ê≠£Á¢∫ÔºÅÂ§™Ê£í‰∫ÜÔºÅ';
                feedback.className = 'feedback correct';
                
                // Áç≤ÂæóË∂ÖËÉΩÂäõÈú∏ÁéãÁçéÂãµ
                const ultramanIndex = collectedUltramen.length % ultramanHeroes.length;
                const newUltraman = ultramanHeroes[ultramanIndex];
                collectedUltramen.push(newUltraman);
                
                let rewardMessage = `
                    <div class="ultraman-character">${newUltraman}</div>
                    <p style="color: #ffeaa7; font-weight: bold; font-size: 1.3em;">Áç≤ÂæóÊñ∞ÁöÑË∂ÖËÉΩÂäõÈú∏ÁéãËã±ÈõÑÔºÅ</p>
                `;
                
                // ÈáåÁ®ãÁ¢ëÊÖ∂Á•ù
                const ultramanCount = collectedUltramen.length;
                if (ultramanCount === 5) {
                    rewardMessage += '<p style="color: #00b894; font-weight: bold;">‚ö° Â§™Ê£í‰∫ÜÔºÅÊî∂ÈõÜ‰∫Ü5‰ΩçËã±ÈõÑÔºÅ</p>';
                    createSpecialEffect('‚ö°');
                } else if (ultramanCount === 10) {
                    rewardMessage += '<p style="color: #74b9ff; font-weight: bold;">üåü ÂìáÔºÅËã±ÈõÑÂúòÈöä‰∏ÄÂçäÈõÜÁµêÔºÅ</p>';
                    createSpecialEffect('üåü');
                } else if (ultramanCount === 15) {
                    rewardMessage += '<p style="color: #e17055; font-weight: bold;">üî• Âø´Ë¶ÅÊàêÂäü‰∫ÜÔºÅÂè™Â∑Æ5‰ΩçËã±ÈõÑÔºÅ</p>';
                    createSpecialEffect('üî•');
                } else if (ultramanCount === 20) {
                    rewardMessage += '<p style="color: #ffeaa7; font-weight: bold;">üéä ÊÅ≠ÂñúÔºÅË∂ÖËÉΩÂäõÈú∏ÁéãÂÖ®Âì°ÈõÜÁµêÔºÅ</p>';
                    createSpecialEffect('üí•');
                }
                
                ultramanReward.innerHTML = rewardMessage;
                ultramanReward.classList.remove('hidden');
                
                updateUltramanCollection();
            } else {
                // È°ØÁ§∫Ê≠£Á¢∫Á≠îÊ°àÂíåÂÖ∑È´îÊôÇÈñì
                const hourStrA = timeA.hour.toString().padStart(2, '0');
                const minuteStrA = timeA.minute.toString().padStart(2, '0');
                const hourStrB = timeB.hour.toString().padStart(2, '0');
                const minuteStrB = timeB.minute.toString().padStart(2, '0');
                
                feedback.textContent = `‚ùå Á≠îÈåØ‰∫ÜÔºÅÊ≠£Á¢∫Á≠îÊ°àÊòØ ${correctDifference.hours} Â∞èÊôÇ ${correctDifference.minutes} ÂàÜÈêò`;
                feedback.className = 'feedback incorrect';
                
                // Êö´ÊôÇÈ°ØÁ§∫Ê≠£Á¢∫ÊôÇÈñìÂπ´Âä©Â≠∏Áøí
                const displayA = document.getElementById('timeDisplayA');
                const displayB = document.getElementById('timeDisplayB');
                displayA.textContent = `ÊôÇÈñìAÔºö${hourStrA}:${minuteStrA}`;
                displayB.textContent = `ÊôÇÈñìBÔºö${hourStrB}:${minuteStrB}`;
                
                ultramanReward.classList.add('hidden');
            }
            
            nextBtn.classList.remove('hidden');
            updateDisplay();
        }
        
        // ÂâµÂª∫ÁâπÊÆäÊïàÊûú
        function createSpecialEffect(emoji) {
            const effect = document.createElement('div');
            effect.className = 'special-effect';
            effect.textContent = emoji;
            effect.style.left = Math.random() * window.innerWidth + 'px';
            effect.style.top = Math.random() * window.innerHeight + 'px';
            document.body.appendChild(effect);
            
            setTimeout(() => {
                effect.remove();
            }, 1500);
        }
        
        // ‰∏ã‰∏ÄÈ°å
        function nextQuestion() {
            if (currentQuestion >= 20) {
                showFinalScreen();
                return;
            }
            
            currentQuestion++;
            generateNewTimes();
            drawClocks();
            showTimeTips();
            
            // ÈáçÁΩÆËº∏ÂÖ•ÂíåÂèçÈ•ã
            document.getElementById('hourInput').value = '';
            document.getElementById('minuteInput').value = '';
            document.getElementById('feedback').textContent = '';
            document.getElementById('feedback').className = 'feedback';
            document.getElementById('ultramanReward').classList.add('hidden');
            document.getElementById('nextBtn').classList.add('hidden');
            
            updateDisplay();
        }
        
        // Êõ¥Êñ∞È°ØÁ§∫
        function updateDisplay() {
            document.getElementById('currentQuestion').textContent = currentQuestion;
            document.getElementById('correctCount').textContent = correctCount;
            document.getElementById('ultramanCount').textContent = collectedUltramen.length;
        }
        
        // Êõ¥Êñ∞Ë∂ÖËÉΩÂäõÈú∏ÁéãÊî∂ÈõÜÈ°ØÁ§∫
        function updateUltramanCollection() {
            const collection = document.getElementById('ultramanCollection');
            const progressText = document.getElementById('progressText');
            const progressFill = document.getElementById('progressFill');
            
            collection.innerHTML = collectedUltramen.map(ultraman => 
                `<div class="ultraman-badge">${ultraman}</div>`
            ).join('');
            
            // Êõ¥Êñ∞ÈÄ≤Â∫¶Ê¢ù
            const progress = (collectedUltramen.length / 20) * 100;
            progressText.textContent = `${collectedUltramen.length}/20`;
            progressFill.style.width = `${progress}%`;
            
            // Â¶ÇÊûúÊî∂ÈõÜÊªø‰∫ÜÔºåÊ∑ªÂä†ÁâπÊÆäÊïàÊûú
            if (collectedUltramen.length === 20) {
                progressFill.style.background = 'linear-gradient(90deg, #ffeaa7, #fdcb6e, #e17055)';
                progressText.style.color = '#ffeaa7';
                progressText.style.fontWeight = 'bold';
                progressText.style.textShadow = '0 0 10px rgba(255, 234, 167, 0.8)';
            }
        }
        
        // È°ØÁ§∫ÊúÄÁµÇÁµêÊûú
        function showFinalScreen() {
            document.getElementById('gameScreen').classList.add('hidden');
            document.getElementById('finalScreen').classList.remove('hidden');
            document.getElementById('finalScore').textContent = correctCount;
            document.getElementById('finalUltramen').textContent = collectedUltramen.length;
            
            // Ê†πÊìöÁ≠îÂ∞çÈ°åÊï∏È°ØÁ§∫‰∏çÂêåÁöÑÈºìÂãµÊ∂àÊÅØ
            const finalMessage = document.getElementById('finalMessage');
            const percentage = (correctCount / 20) * 100;
            
            if (percentage === 100) {
                finalMessage.innerHTML = 'üèÜ Â§™Ê£í‰∫ÜÔºÅÂÖ®ÈÉ®Á≠îÂ∞çÔºÅ‰Ω†ÊòØÊôÇÈêòË®àÁÆóÂ§ßÂ∏´ÔºÅ<br>ü§ñ Ë∂ÖËÉΩÂäõÈú∏ÁéãÂÖ®Âì°ÈõÜÁµêÔºåÂÆáÂÆôÂíåÂπ≥Èù†‰Ω†‰∫ÜÔºÅ';
                finalMessage.style.color = '#ffeaa7';
            } else if (percentage >= 80) {
                finalMessage.innerHTML = '‚ö° ÈùûÂ∏∏ÂÑ™ÁßÄÔºÅ‰Ω†Â∞çÊôÇÈñìË®àÁÆóÂæàÁÜüÁ∑¥ÔºÅ<br>üåü Ë∂ÖËÉΩÂäõÈú∏ÁéãËã±ÈõÑÂÄëÈÉΩÂæà‰Ω©Êúç‰Ω†ÔºÅ';
                finalMessage.style.color = '#00b894';
            } else if (percentage >= 60) {
                finalMessage.innerHTML = 'üöÄ ÂÅöÂæóÂæàÂ•ΩÔºÅÁπºÁ∫åÁ∑¥ÁøíÊúÉÊõ¥Ê£íÔºÅ<br>üí´ Â∑≤Á∂ìÊî∂ÈõÜ‰∫ÜÂæàÂ§öË∂ÖËÉΩÂäõÈú∏ÁéãËã±ÈõÑÔºÅ';
                finalMessage.style.color = '#74b9ff';
            } else if (percentage >= 40) {
                finalMessage.innerHTML = 'üí™ ‰∏çÈåØÁöÑÈñãÂßãÔºÅÂ§öÁ∑¥ÁøíÂ∞±ÊúÉÈÄ≤Ê≠•ÔºÅ<br>üîÆ Ë∂ÖËÉΩÂäõÈú∏ÁéãËã±ÈõÑÂÄëÂú®Á≠â‰Ω†ËÆäÂæóÊõ¥Âº∑ÔºÅ';
                finalMessage.style.color = '#a29bfe';
            } else {
                finalMessage.innerHTML = 'üå± Â≠∏ÁøíÊòØÂÄãÈÅéÁ®ãÔºåÂÜçË©¶‰∏ÄÊ¨°ÂêßÔºÅ<br>ü§ñ Ë∂ÖËÉΩÂäõÈú∏ÁéãËã±ÈõÑÂÄëÊúÉÈô™‰º¥‰Ω†Á∑¥ÁøíÔºÅ';
                finalMessage.style.color = '#fd79a8';
            }
        }
        
        // ÈáçÊñ∞ÈñãÂßãÈÅäÊà≤
        function restartGame() {
            currentQuestion = 1;
            correctCount = 0;
            collectedUltramen = [];
            
            document.getElementById('gameScreen').classList.remove('hidden');
            document.getElementById('finalScreen').classList.add('hidden');
            document.getElementById('ultramanCollection').innerHTML = '';
            
            // ÈáçÁΩÆÈÄ≤Â∫¶Ê¢ù
            const progressFill = document.getElementById('progressFill');
            const progressText = document.getElementById('progressText');
            progressFill.style.width = '0%';
            progressFill.style.background = 'linear-gradient(90deg, #00b894, #00cec9, #74b9ff)';
            progressText.style.color = '#ffeaa7';
            progressText.style.fontWeight = 'bold';
            progressText.style.textShadow = '1px 1px 2px rgba(0,0,0,0.5)';
            
            initGame();
        }
        
        // ÊåâEnterÈçµÊèê‰∫§Á≠îÊ°à
        document.addEventListener('keypress', function(e) {
            if (e.key === 'Enter') {
                const nextBtn = document.getElementById('nextBtn');
                if (!nextBtn.classList.contains('hidden')) {
                    nextQuestion();
                } else {
                    checkAnswer();
                }
            }
        });
        
        // Ëá™ÂãïÊ†ºÂºèÂåñËº∏ÂÖ•
        function formatInput(inputId, maxValue) {
            const input = document.getElementById(inputId);
            input.addEventListener('input', function() {
                let value = this.value.replace(/\D/g, ''); // Âè™‰øùÁïôÊï∏Â≠ó
                if (value.length > 2) {
                    value = value.substring(0, 2);
                }
                if (parseInt(value) > maxValue) {
                    value = maxValue.toString();
                }
                this.value = value;
            });
        }
        
        // ÂàùÂßãÂåñËº∏ÂÖ•Ê†ºÂºèÂåñ
        formatInput('hourInput', 12);
        formatInput('minuteInput', 59);
        
        // ÂïüÂãïÈÅäÊà≤
        initGame();
    </script>
</body>
</html>